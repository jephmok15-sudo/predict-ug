<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Predict UG - Secure Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    background:black;
    color:white;
    font-family: Arial, sans-serif;
    padding:15px;
}
h1{
    color:red;
    text-align:center;
}
.card{
    background:#111;
    padding:15px;
    border-radius:10px;
    margin-bottom:15px;
    box-shadow:0 0 10px #000;
}
input, textarea, button{
    width:100%;
    padding:12px;
    margin-top:10px;
    background:#222;
    color:white;
    border:1px solid #444;
    border-radius:6px;
}
button{
    background:red;
    font-weight:bold;
    cursor:pointer;
}
.statBox{
    display:flex;
    gap:10px;
}
.stat{
    flex:1;
    text-align:center;
    background:#000;
    padding:10px;
    border-radius:8px;
}
small{
    color:#aaa;
}
</style>
</head>

<body>

<script>
// PASSWORD PROTECTION (hidden)
var password = prompt("Enter Admin Password:");

if(password !== "predictUG@2025"){
  document.body.innerHTML = "<h2 style='color:red;text-align:center;margin-top:50px;'>ACCESS DENIED</h2>";
  throw new Error("Wrong password");
}
</script>

<h1>PREDICT UG â€” SECURE ADMIN</h1>

<div class="card">
<h3>ðŸ“Š Platform Stats (Live)</h3>
<div class="statBox">
  <div class="stat"><h2 id="totalPred">0</h2><small>Predictions</small></div>
  <div class="stat"><h2 id="totalPoints">0</h2><small>Points</small></div>
  <div class="stat"><h2 id="totalEarn">UGX 0</h2><small>Earnings</small></div>
</div>
</div>

<div class="card">
<h3>âž• Add Prediction</h3>
<input id="match" placeholder="Match / Event">
<input id="odds" placeholder="Odds">
<textarea id="details" placeholder="Prediction details"></textarea>
<input id="points" placeholder="Points (numbers only)">
<button onclick="addPrediction()">PUBLISH</button>
</div>

<div class="card">
<h3>ðŸ“¢ Ad / Affiliate Section</h3>
<textarea id="adHtml" placeholder="Paste Ad HTML / Image / Video iframe here"></textarea>
<button onclick="saveAd()">SAVE AD</button>
</div>

<div class="card">
<h3>ðŸ’µ Earnings Control</h3>
<input id="earningsInput" placeholder="UGX amount">
<button onclick="saveEarnings()">UPDATE EARNINGS</button>
</div>

<div class="card">
<h3>ðŸ“‹ Active Predictions</h3>
<div id="allPredictions">Loading...</div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBnIeC8g8sx0KxKgoHQNqRlT3u3EVYA_10",
  authDomain: "predict-ug.firebaseapp.com",
  databaseURL: "https://predict-ug-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "predict-ug",
  storageBucket: "predict-ug.appspot.com",
  messagingSenderId: "904307610384",
  appId: "1:904307610384:web:588965a0949648ff89cb95"
};

firebase.initializeApp(firebaseConfig);

const db = firebase.database();

function addPrediction(){
  let match = document.getElementById("match").value;
  let odds = document.getElementById("odds").value;
  let details = document.getElementById("details").value;
  let points = document.getElementById("points").value;

  if(match && odds && details){
    db.ref("predictions").push({
      match, odds, details,
      points: Number(points) || 0,
      time: new Date().toLocaleString()
    });

    document.getElementById("match").value = "";
    document.getElementById("odds").value = "";
    document.getElementById("details").value = "";
    document.getElementById("points").value = "";

    alert("Prediction Published!");
  }
}

function saveAd(){
  let ad = document.getElementById("adHtml").value;

  db.ref("adsAffiliate").set({
    customAd: ad
  });

  alert("Ad Saved!");
}

function saveEarnings(){
  let earn = document.getElementById("earningsInput").value;

  db.ref("stats/earnings").set(earn);

  alert("Earnings Updated!");
}

/* LIVE STATS */

db.ref("predictions").on("value", snap=>{
  let data = snap.val();
  let total = data ? Object.keys(data).length : 0;
  let totalPoints = 0;

  if(data){
    Object.values(data).forEach(p=>{
      totalPoints += Number(p.points || 0);
    });
  }

  document.getElementById("totalPred").innerText = total;
  document.getElementById("totalPoints").innerText = totalPoints;
});

db.ref("stats/earnings").on("value", snap=>{
  document.getElementById("totalEarn").innerText = "UGX " + (snap.val() || 0);
});

/* SHOW PREDICTIONS LIST */
db.ref("predictions").on("value", snap=>{
  let box = document.getElementById("allPredictions");
  box.innerHTML = "";

  let data = snap.val();
  if(!data){
    box.innerHTML = "<small>No predictions yet</small>";
    return;
  }

  Object.values(data).reverse().forEach(p=>{
    box.innerHTML += `
      <div style="border-bottom:1px solid #333;padding:10px 0;">
        <b>${p.match}</b><br>
        Odds: ${p.odds}<br>
        ${p.details}<br>
        <small>${p.time}</small>
      </div>
    `;
  });

});
</script>

</body>
</html>